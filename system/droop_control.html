<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Droop Control | Building DC Energy Systems</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    <link rel="manifest" href="/favicons/site.webmanifest">
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#5bbad5">
    <link rel="shortcut icon" href="/favicons/favicon.ico">
    <meta name="description" content="Open Educational Resource (OER) by Libre Solar to explain how to develop, produce and use components for DC energy systems">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/assets/css/0.styles.a59f50a4.css" as="style"><link rel="preload" href="/assets/js/app.9726dff0.js" as="script"><link rel="preload" href="/assets/js/3.1248d68c.js" as="script"><link rel="preload" href="/assets/js/12.7c005d40.js" as="script"><link rel="preload" href="/assets/js/46.3c883e13.js" as="script"><link rel="preload" href="/assets/js/17.8553520e.js" as="script"><link rel="prefetch" href="/assets/js/1.f34d92d0.js"><link rel="prefetch" href="/assets/js/10.906c93cf.js"><link rel="prefetch" href="/assets/js/11.83f3917c.js"><link rel="prefetch" href="/assets/js/13.2c91f8cb.js"><link rel="prefetch" href="/assets/js/14.68dde8eb.js"><link rel="prefetch" href="/assets/js/15.fa007e83.js"><link rel="prefetch" href="/assets/js/16.bfba9102.js"><link rel="prefetch" href="/assets/js/18.16199cf1.js"><link rel="prefetch" href="/assets/js/19.5e5335f0.js"><link rel="prefetch" href="/assets/js/20.7b66e561.js"><link rel="prefetch" href="/assets/js/21.f1f925cd.js"><link rel="prefetch" href="/assets/js/22.df799ee1.js"><link rel="prefetch" href="/assets/js/23.05aeb2ac.js"><link rel="prefetch" href="/assets/js/24.dab9baf2.js"><link rel="prefetch" href="/assets/js/25.9175280b.js"><link rel="prefetch" href="/assets/js/26.e63cd1e9.js"><link rel="prefetch" href="/assets/js/27.1899f0f4.js"><link rel="prefetch" href="/assets/js/28.abb2a0ca.js"><link rel="prefetch" href="/assets/js/29.a61770a2.js"><link rel="prefetch" href="/assets/js/30.e343af75.js"><link rel="prefetch" href="/assets/js/31.805ee13d.js"><link rel="prefetch" href="/assets/js/32.83ebd1ae.js"><link rel="prefetch" href="/assets/js/33.9b574342.js"><link rel="prefetch" href="/assets/js/34.177d056d.js"><link rel="prefetch" href="/assets/js/35.9fd7fd17.js"><link rel="prefetch" href="/assets/js/36.ac5fd5ce.js"><link rel="prefetch" href="/assets/js/37.28876a9c.js"><link rel="prefetch" href="/assets/js/38.07ec2786.js"><link rel="prefetch" href="/assets/js/39.3a108839.js"><link rel="prefetch" href="/assets/js/4.f3535127.js"><link rel="prefetch" href="/assets/js/40.95ef1a16.js"><link rel="prefetch" href="/assets/js/41.00468b31.js"><link rel="prefetch" href="/assets/js/42.c10f4714.js"><link rel="prefetch" href="/assets/js/43.98a925f8.js"><link rel="prefetch" href="/assets/js/44.373964ed.js"><link rel="prefetch" href="/assets/js/45.3f5cd47f.js"><link rel="prefetch" href="/assets/js/47.3b8576a6.js"><link rel="prefetch" href="/assets/js/48.391c0688.js"><link rel="prefetch" href="/assets/js/49.e032336f.js"><link rel="prefetch" href="/assets/js/5.1acad389.js"><link rel="prefetch" href="/assets/js/50.054c3b43.js"><link rel="prefetch" href="/assets/js/51.69398263.js"><link rel="prefetch" href="/assets/js/52.646ac5cb.js"><link rel="prefetch" href="/assets/js/6.84702c01.js"><link rel="prefetch" href="/assets/js/7.d9c69024.js"><link rel="prefetch" href="/assets/js/8.49ea59c4.js"><link rel="prefetch" href="/assets/js/9.23791fb3.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a59f50a4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Building DC Energy Systems</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/system/" class="nav-link router-link-active">
  System Layout
</a></div><div class="nav-item"><a href="/development/" class="nav-link">
  Component Development
</a></div><div class="nav-item"><a href="/production/" class="nav-link">
  Production
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/system/" class="nav-link router-link-active">
  System Layout
</a></div><div class="nav-item"><a href="/development/" class="nav-link">
  Component Development
</a></div><div class="nav-item"><a href="/production/" class="nav-link">
  Production
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Generation</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/solar_panel.html" class="sidebar-link">Solar Panel</a></li><li><a href="/system/wind_turbine.html" class="sidebar-link">Wind Turbines</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Storage</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/battery.html" class="sidebar-link">Battery</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Power Electronics</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/charge_controller.html" class="sidebar-link">Charge Controller</a></li><li><a href="/system/bms.html" class="sidebar-link">Battery Management System</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Connections</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/wires_fuses.html" class="sidebar-link">Wires and Fuses</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>DC Grid</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/system/grid_architecture.html" class="sidebar-link">Grid Architecture</a></li><li><a href="/system/droop_control.html" aria-current="page" class="active sidebar-link">Droop Control</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/system/droop_control.html#renewable-energy-source" class="sidebar-link">Renewable energy source</a></li><li class="sidebar-sub-header"><a href="/system/droop_control.html#energy-storage-device" class="sidebar-link">Energy storage device</a></li><li class="sidebar-sub-header"><a href="/system/droop_control.html#smart-load" class="sidebar-link">Smart load</a></li><li class="sidebar-sub-header"><a href="/system/droop_control.html#grid-connection" class="sidebar-link">Grid connection</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="droop-control"><a href="#droop-control" class="header-anchor">#</a> Droop Control</h1> <p>If the DC grid voltage is decoupled from all power sources and sinks, the locally measured voltage of each grid participant can be used to control the power flows within the grid.</p> <p>This chapter describes the control mode of the grid port for most important grid participants.</p> <p>The voltage setpoints can be set arbitrarily. Here we use setpoints currently implemented in a 48V grid pilot developed by Libre Solar for demonstration.</p> <p>As a convention, current/power flow towards the grid (export) has a positive sign and current consumed from the grid (import) has a negative sign.</p> <h2 id="renewable-energy-source"><a href="#renewable-energy-source" class="header-anchor">#</a> Renewable energy source</h2> <p>A renewable energy source (e.g. solar panel) connected to the grid via a DC/DC converter will only export power to the grid.</p> <p>The operating range of the converter at the grid side is shown in Fig. 1.</p> <figure><center><img src="/images/system/droop_control_solar.svg" alt="Droop control: Renewable energy source" height="auto" width="auto"> <figcaption><b>Figure 1.</b> Droop control: Renewable energy source.</figcaption></center></figure> <p>If no power is consumed from the grid, the grid controller will ramp up the grid voltage until it reaches is maximum grid voltage setpoint <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo>=</mo><mn>55</mn><mtext></mtext><mi mathvariant="normal">V</mi></mrow><annotation encoding="application/x-tex">v_{max} = 55\,\mathrm{V}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord">5</span><span class="mord">5</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">V</span></span></span></span></span></span>. As soon as power is consumed, the controller tries to maintain that voltage until it reaches its maximum input power limit <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{max}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span>. For a solar panel, this is the maximum power point (MPP), which mainly depends on the solar irradiance. If the power consumed in the grid increases further, the converter cannot maintain the voltage anymore. It will drop until it reaches the maximum current limit of the device and finally completely break down if the demand in the grid is not reduced.</p> <h2 id="energy-storage-device"><a href="#energy-storage-device" class="header-anchor">#</a> Energy storage device</h2> <p>An energy storage device like a Lithium-ion battery can import and export power, as shown in Fig. 2.</p> <figure><center><img src="/images/system/droop_control_battery.svg" alt="Droop control: Energy storage device" height="auto" width="auto"> <figcaption><b>Figure 2.</b> Droop control: Energy storage device.</figcaption></center></figure> <p>It will import at high grid voltages and export at lower voltages to support the grid.</p> <p>Between importing and exporting mode, the battery needs a voltage hysteresis to prevent charge transfer between batteries.</p> <p>In contrast to the solar panel, the operating curve of an energy storage device has a slope, which is called the droop curve. This droop makes the system react like a voltage source with a series resistor. If the power increases, the voltage drops, indicating that the load in the system is high. This behavior is used to control the grid, as explained further down below.</p> <p>If the state of charge (SOC) of the battery is high, the operating curve can be slightly moved upwards, which causes full batteries to start exporting their energy before batteries with low state of charge.</p> <h2 id="smart-load"><a href="#smart-load" class="header-anchor">#</a> Smart load</h2> <p>Loads can be connected directly to the grid and don't have to be smart, i.e. measure the grid voltage and change their operation depending on it.</p> <p>However, in order to prioritize different loads depending on the available power or energy, it makes sense to implement at least a threshold below which a load would shut off itself.</p> <p>If possible, a load should also implement a droop curve behavior, as shown in Fig. 3.</p> <figure><center><img src="/images/system/droop_control_load.svg" alt="Droop control: Smart load (pure consumer)" height="auto" width="auto"> <figcaption><b>Figure 3.</b> Droop control: Smart load (pure consumer).</figcaption></center></figure> <p>Loads with low priority operate only at high grid voltages.</p> <p>The line indicated with &quot;low prio&quot; would switch the load on only after all batteries have been fully charged (i.e. don't pull the grid voltage down anymore). So it would only use abundant renewable energy. This method could be used for heating or other wasteful uses of electricity.</p> <p>The high priority load with dashed lines would only get switched off when there is no energy left in the grid at all.</p> <h2 id="grid-connection"><a href="#grid-connection" class="header-anchor">#</a> Grid connection</h2> <p>As a demonstration how the different participants interact with each other via the droop control mechanism, Fig. 4 shows a very simple grid with only one solar panel (left side) and one battery (right side).</p> <figure><center><img src="/images/system/droop_control_solar_battery.svg" alt="DC nanogrid overview" height="auto" width="auto"> <figcaption><b>Figure 1.</b> DC nanogrid overview.</figcaption></center></figure> <p>The red line indicates the equilibrium which is automatically reached when those two grid interfaces are connected. The solar converter operates in its maximum power point and the battery consumes exactly the same amount of current as provided by the solar panel towards the grid (neglecting any losses).</p> <p>If the solar panel gets shaded, the maximum power will decrease and the <span class="vuepress-eq"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{max}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span> curve will move to the left. The battery controller will immediately react and reduce the imported current. The resulting grid voltage will be lower than before.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/LibreSolar/learn.libre.solar/edit/main/docs/system/droop_control.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/13/2021, 8:19:48 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/system/grid_architecture.html" class="prev">
        Grid Architecture
      </a></span> <!----></p></div>  <div class="footer">
    Content provided by <a href="https://libre.solar">Libre Solar</a> under <a href="https://creativecommons.org/licenses/by-sa/4.0/legalcode">CC-BY-SA 4.0 License</a> | <a href="https://libre.solar/about/contact/">Contact / Impressum</a></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.9726dff0.js" defer></script><script src="/assets/js/3.1248d68c.js" defer></script><script src="/assets/js/12.7c005d40.js" defer></script><script src="/assets/js/46.3c883e13.js" defer></script><script src="/assets/js/17.8553520e.js" defer></script>
  </body>
</html>
